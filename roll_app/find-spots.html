<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Find Spots ‚Äì Roll ‚Äôn Connect</title>

  <link rel="stylesheet" href="styles/style.css">

  <!-- MAPBOX -->
  <script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
  <link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet" />

  <style>
    body {
      background:#000;
      color:#fff;
      margin:0;
      padding:0;
      font-family:'Inter',sans-serif;
      overflow:hidden;
    }

    /* STARFIELDS */
    .stars1,.stars2,.stars3 {
      position:fixed; inset:0;
      background:url('styles/stars-white.png') repeat;
      z-index:-3;
    }
    .stars1{opacity:.55;animation:drift1 140s linear infinite;}
    .stars2{opacity:.35;animation:drift2 200s linear infinite;}
    .stars3{opacity:.2; animation:drift3 260s linear infinite;}

    @keyframes drift1{from{background-position:0 0;}to{background-position:0 -5000px;}}
    @keyframes drift2{from{background-position:0 0;}to{background-position:-4000px -2000px;}}
    @keyframes drift3{from{background-position:0 0;}to{background-position:3000px 4000px;}}

    /* HAMBURGER */
    .hamburger {
      position: fixed;
      top: 25px;
      left: 25px;
      width: 36px;
      height: 28px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      cursor: pointer;
      z-index: 9999;
    }
    .hamburger span {
      height: 4px;
      width: 100%;
      background: #ffffff;
      border-radius: 4px;
      box-shadow: 0 0 10px rgba(255,255,255,0.8);
      transition: 0.3s;
    }
    .hamburger.active span:nth-child(1){transform:translateY(12px) rotate(45deg);}
    .hamburger.active span:nth-child(2){opacity:0;}
    .hamburger.active span:nth-child(3){transform:translateY(-12px) rotate(-45deg);}

    /* SIDEBAR */
    .sidebar {
      position: fixed;
      top: 0;
      left: -260px;
      width: 260px;
      height: 100vh;
      background: rgba(255,255,255,0.06);
      backdrop-filter: blur(20px);
      border-right: 1px solid rgba(255,255,255,0.15);
      padding: 30px 20px;
      box-shadow: 5px 0 25px rgba(255,255,255,0.15);
      display: flex;
      flex-direction: column;
      z-index: 9998;
      transition: 0.35s ease;
    }
    .sidebar.open { left: 0; }

    .nav-header{text-align:center;margin-bottom:40px;}
    .logo-orb{font-size:3rem;margin-bottom:10px;}
    .nav-title{font-size:1.4rem;font-weight:600;}

    .nav-links{list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:18px;}
    .nav-links a{
      color:#fff;text-decoration:none;font-size:1.15rem;
      padding:10px 14px;border-radius:12px;transition:0.25s;
    }
    .nav-links a:hover{
      background:rgba(255,255,255,0.15);
      transform:translateX(6px);
    }

    /* MAP */
    #map {
      position: absolute;
      top: 0;
      left: 0;
      width: calc(100% - 0px);
      height: 100vh;
      z-index: 1;
    }

    /* SEARCH BAR */
    .search-box {
      position: fixed;
      top: 25px;
      right: 25px;
      z-index: 9999;
      background: rgba(0,0,0,0.6);
      padding: 12px 18px;
      border-radius: 12px;
      backdrop-filter: blur(10px);
      box-shadow: 0 0 20px rgba(255,255,255,0.3);
    }
    .search-box input {
      background: transparent;
      border: none;
      color: #fff;
      font-size: 1rem;
      outline: none;
    }
  </style>
</head>

<body>

<div class="stars1"></div>
<div class="stars2"></div>
<div class="stars3"></div>

<!-- HAMBURGER -->
<div id="hamburger" class="hamburger">
  <span></span><span></span><span></span>
</div>

<!-- SIDEBAR -->
<nav id="sidebar" class="sidebar">
  <div class="nav-header">
    <div class="logo-orb">üõº</div>
    <div class="nav-title">Roll ‚Äôn Connect</div>
  </div>

  <ul class="nav-links">
    <li><a href="index.html">üè† Home</a></li>
    <li><a href="dashboard.html">üìä Dashboard</a></li>
    <li><a href="chatrooms.html">üí¨ Chatrooms</a></li>
    <li><a href="events.html">üìÖ Events</a></li>
    <li><a href="calendar.html">üóìÔ∏è Calendar</a></li>
    <li><a href="profile.html">üë§ Your Profile</a></li>
    <li><a href="profile-edit.html">‚úèÔ∏è Edit Profile</a></li>
    <li><a href="settings.html">‚öôÔ∏è Settings</a></li>
  </ul>
</nav>

<!-- SEARCH BAR -->
<div class="search-box">
  <input id="searchInput" placeholder="Search: skatepark, rink, trail, lot...">
</div>

<!-- MAP -->
<div id="map"></div>

<script>
  // SIDEBAR TOGGLE
  const h = document.getElementById("hamburger");
  const s = document.getElementById("sidebar");
  h.onclick = () => { h.classList.toggle("active"); s.classList.toggle("open"); };

  // MAPBOX INIT
  mapboxgl.accessToken = "YOUR_MAPBOX_KEY_HERE";

  const map = new mapboxgl.Map({
    container: "map",
    style: "mapbox://styles/mapbox/dark-v11",
    center: [-84.3, 33.8], // Atlanta default
    zoom: 11
  });

  // USER LOCATION
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(pos => {
      const { latitude, longitude } = pos.coords;

      map.setCenter([longitude, latitude]);

      // Load profile avatar
      const profile = JSON.parse(localStorage.getItem("rc_profile") || "{}");
      const avatar = profile.avatarUrl || "styles/default-avatar.png";

      // Custom marker with avatar
      const el = document.createElement("div");
      el.style.width = "40px";
      el.style.height = "40px";
      el.style.borderRadius = "50%";
      el.style.backgroundImage = `url('${avatar}')`;
      el.style.backgroundSize = "cover";
      el.style.boxShadow = "0 0 10px rgba(255,255,255,0.8)";

      new mapboxgl.Marker(el)
        .setLngLat([longitude, latitude])
        .addTo(map);
    });
  }

  // SEARCH FUNCTION
  document.getElementById("searchInput").addEventListener("keydown", e => {
    if (e.key === "Enter") {
      const q = e.target.value;
      fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${q}.json?proximity=ip&access_token=${mapboxgl.accessToken}`)
        .then(r => r.json())
        .then(data => {
          if (!data.features.length) return;

          const spot = data.features[0];
          map.flyTo({ center: spot.center, zoom: 14 });

          new mapboxgl.Marker()
            .setLngLat(spot.center)
            .setPopup(new mapboxgl.Popup().setHTML(`<strong>${spot.text}</strong><br>${spot.place_name}`))
            .addTo(map);
        });
    }
  });
</script>

</body>
</html>
