<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Marketplace Item ‚Äì Roll ‚Äôn Connect</title>

  <style>
    body{
      background:#000;color:#fff;margin:0;padding:0;
      font-family:'Inter',sans-serif;overflow-x:hidden;overflow-y:auto;
    }

    .stars1,.stars2,.stars3{
      position:fixed;inset:0;
      background:url('styles/stars-white.png') repeat;
      z-index:-3;pointer-events:none;
    }
    .stars1{opacity:.55;animation:drift1 140s linear infinite;}
    .stars2{opacity:.35;animation:drift2 200s linear infinite;}
    .stars3{opacity:.2;animation:drift3 260s linear infinite;}
    @keyframes drift1{from{background-position:0 0;}to{background-position:0 -5000px;}}
    @keyframes drift2{from{background-position:0 0;}to{background-position:-4000px -2000px;}}
    @keyframes drift3{from{background-position:0 0;}to{background-position:3000px 4000px;}}

    .sidebar{
      position:fixed;top:50%;left:-260px;transform:translateY(-50%);
      width:260px;background:rgba(10,10,20,0.9);
      backdrop-filter:blur(25px);
      border-right:1px solid rgba(255,255,255,0.25);
      padding:26px 20px;border-radius:0 20px 20px 0;
      box-shadow:10px 0 40px rgba(0,0,0,0.7);
      transition:0.35s ease;z-index:9000;
    }
    .sidebar.open{left:0;}

    .hamburger{
      position:fixed;top:25px;left:25px;width:40px;height:30px;
      display:flex;flex-direction:column;justify-content:space-between;
      cursor:pointer;z-index:9500;
    }
    .hamburger span{
      height:3px;width:100%;background:#fff;border-radius:4px;
      box-shadow:0 0 8px rgba(255,255,255,0.9);transition:0.3s;
    }
    .hamburger.active span:nth-child(1){transform:translateY(12px) rotate(45deg);}
    .hamburger.active span:nth-child(2){opacity:0;}
    .hamburger.active span:nth-child(3){transform:translateY(-12px) rotate(-45deg);}

    .nav-header{text-align:center;margin-bottom:24px;}
    .logo-orb{font-size:2.4rem;margin-bottom:6px;text-shadow:0 0 20px rgba(255,255,255,0.9);}
    .nav-title{font-size:1.2rem;font-weight:600;text-shadow:0 0 10px rgba(255,255,255,0.7);}
    .nav-links{list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:12px;}
    .nav-links a{
      display:block;color:#fff;text-decoration:none;font-size:0.95rem;
      padding:8px 12px;border-radius:10px;background:rgba(255,255,255,0.05);
      box-shadow:0 0 10px rgba(255,255,255,0.15);transition:0.25s;
    }
    .nav-links a:hover{
      background:rgba(255,255,255,0.2);
      transform:translateX(5px);
      box-shadow:0 0 18px rgba(255,255,255,0.4);
    }

    .page-wrapper{
      max-width:900px;margin:0 auto;padding:120px 20px 80px;
    }

    .item-top{
      display:flex;flex-wrap:wrap;gap:24px;margin-bottom:30px;
    }
    .item-image{
      flex:0 0 280px;height:280px;border-radius:20px;
      background:rgba(255,255,255,0.15);overflow:hidden;
      box-shadow:0 0 40px rgba(255,255,255,0.3);
    }
    .item-image img{width:100%;height:100%;object-fit:cover;}
    .item-main{flex:1;min-width:260px;}

    .item-title{font-size:2rem;font-weight:700;margin-bottom:8px;}
    .item-disc{font-size:1rem;opacity:0.85;margin-bottom:6px;}
    .item-price{font-size:1.4rem;margin-bottom:10px;}
    .item-donate-label{font-size:0.9rem;opacity:0.9;margin-bottom:10px;}

    label{font-size:0.85rem;opacity:0.85;display:block;margin-bottom:4px;}
    input,textarea,select{
      width:100%;padding:10px 12px;margin-bottom:16px;
      border:none;border-radius:12px;
      background:rgba(255,255,255,0.16);color:#fff;font-size:0.95rem;
    }
    textarea{resize:vertical;}
    .toggle-row{display:flex;align-items:center;gap:10px;margin-bottom:16px;}
    .toggle-row input[type="checkbox"]{width:auto;height:auto;}

    .btn-primary{
      padding:10px 18px;background:#fff;color:#000;
      border-radius:12px;border:none;font-weight:600;cursor:pointer;margin-right:10px;
    }
    .btn-danger{
      padding:10px 18px;background:#ff4b4b;color:#fff;
      border-radius:12px;border:none;font-weight:600;cursor:pointer;
    }
  </style>
</head>
<body>

<div class="stars1"></div><div class="stars2"></div><div class="stars3"></div>

<div id="hamburger" class="hamburger"><span></span><span></span><span></span></div>

<nav id="sidebar" class="sidebar">
  <div class="nav-header">
    <div class="logo-orb">üõí</div>
    <div class="nav-title">Item Detail</div>
  </div>
  <ul class="nav-links">
    <li><a href="marketplace.html">‚¨Ö Back to Marketplace</a></li>
    <li><a href="index.html">üè† Home</a></li>
  </ul>
</nav>

<div class="page-wrapper" id="wrapper" style="display:none;">
  <div class="item-top">
    <div class="item-image" id="itemImageBox"></div>
    <div class="item-main">
      <div class="item-title" id="itemTitleText"></div>
      <div class="item-disc" id="itemDiscText"></div>
      <div class="item-price" id="itemPriceText"></div>
      <div class="item-donate-label" id="itemDonateText"></div>
    </div>
  </div>

  <div>
    <label>Title</label>
    <input id="editTitle">

    <div style="display:flex;gap:12px;">
      <div style="flex:1;">
        <label>Price (USD)</label>
        <input id="editPrice">
      </div>
      <div style="flex:1;">
        <label>Discipline</label>
        <select id="editDiscipline">
          <option value="">Select</option>
          <option value="Quads">Quads</option>
          <option value="Blades">Blades</option>
          <option value="Longboard">Longboard</option>
          <option value="Skateboard">Skateboard</option>
          <option value="Other">Other</option>
        </select>
      </div>
    </div>

    <label>Description</label>
    <textarea id="editDescription" rows="3"></textarea>

    <label>Change Image</label>
    <input id="editImage" type="file" accept="image/*">

    <div class="toggle-row">
      <input type="checkbox" id="editDonate">
      <label for="editDonate">Donate this item to the Giveaway pool</label>
    </div>

    <button class="btn-primary" id="saveBtn">Save</button>
    <button class="btn-danger" id="deleteBtn">Delete Item</button>
  </div>
</div>

<div id="notFound" style="display:none;text-align:center;padding-top:160px;">
  Item not found.
</div>

<script>
  const hb=document.getElementById("hamburger"), sb=document.getElementById("sidebar");
  hb.onclick=()=>{hb.classList.toggle("active");sb.classList.toggle("open");};

  function getItems(){
    try{return JSON.parse(localStorage.getItem("rc_marketplace_items") || "[]");}
    catch(e){return [];}
  }
  function saveItems(items){
    localStorage.setItem("rc_marketplace_items",JSON.stringify(items));
  }

  function getIdFromQuery(){
    const params=new URLSearchParams(window.location.search);
    return params.get("id");
  }

  const id=getIdFromQuery();
  const items=getItems();
  const idx=items.findIndex(i=>i.id===id);
  const wrapper=document.getElementById("wrapper");
  const notFound=document.getElementById("notFound");

  if(idx===-1){
    notFound.style.display="block";
  }else{
    wrapper.style.display="block";
    let item=items[idx];

    const imgBox=document.getElementById("itemImageBox");
    const tTitle=document.getElementById("itemTitleText");
    const tDisc=document.getElementById("itemDiscText");
    const tPrice=document.getElementById("itemPriceText");
    const tDonate=document.getElementById("itemDonateText");

    const eTitle=document.getElementById("editTitle");
    const ePrice=document.getElementById("editPrice");
    const eDisc=document.getElementById("editDiscipline");
    const eDesc=document.getElementById("editDescription");
    const eImage=document.getElementById("editImage");
    const eDonate=document.getElementById("editDonate");
    const saveBtn=document.getElementById("saveBtn");
    const deleteBtn=document.getElementById("deleteBtn");

    function render(){
      imgBox.innerHTML = item.imageDataUrl ? `<img src="${item.imageDataUrl}">` : "";
      tTitle.textContent=item.title;
      tDisc.textContent=item.discipline || "Unlabeled";
      tPrice.textContent="$"+item.price;
      tDonate.textContent=item.donateToGiveaway ? "Donated to Giveaway pool" : "Not donated";

      eTitle.value=item.title;
      ePrice.value=item.price;
      eDisc.value=item.discipline || "";
      eDesc.value=item.description || "";
      eDonate.checked=!!item.donateToGiveaway;
    }
    render();

    saveBtn.onclick=()=>{
      item.title=eTitle.value.trim() || item.title;
      item.price=ePrice.value.trim() || item.price;
      item.discipline=eDisc.value;
      item.description=eDesc.value.trim();
      item.donateToGiveaway=eDonate.checked;

      const file=eImage.files[0];
      function finish(imgData){
        if(imgData!==null) item.imageDataUrl=imgData;
        items[idx]=item;
        saveItems(items);
        render();
      }
      if(file){
        const reader=new FileReader();
        reader.onload=e=>finish(e.target.result);
        reader.readAsDataURL(file);
      }else{
        finish(null);
      }
    };

    deleteBtn.onclick=()=>{
      if(!confirm("Delete this item?"))return;
      items.splice(idx,1);
      saveItems(items);
      window.location.href="marketplace.html";
    };
  }
</script>

</body>
</html>
