<script>
  const hb = document.getElementById("hamburger"),
        sb = document.getElementById("sidebar");
  hb.onclick = () => { hb.classList.toggle("active"); sb.classList.toggle("open"); };

  /* ===== STORAGE KEYS ===== */
  const LS_PROFILE = "rc_user_profile";
  const LS_LESSONS = "rc_user_lessons";

  /* ===== LOAD PROFILE ===== */
  let profile = JSON.parse(localStorage.getItem(LS_PROFILE) || "{}");
  profile.posts = profile.posts || [];

  /* ===== LOAD LESSONS ===== */
  function getLessons() {
    return JSON.parse(localStorage.getItem(LS_LESSONS) || "[]");
  }
  function saveLessons(list) {
    localStorage.setItem(LS_LESSONS, JSON.stringify(list));
  }

  /* ===== FILL INPUTS ===== */
  const nameEl = document.getElementById("name");
  const bioEl = document.getElementById("bio");
  const linkEl = document.getElementById("link");
  const instaEl = document.getElementById("instagram");
  const postsList = document.getElementById("postsList");
  const lessonsList = document.getElementById("lessonsList");

  nameEl.value = profile.name || "";
  bioEl.value = profile.bio || "";
  linkEl.value = profile.link || "";
  instaEl.value = profile.instagram || "";

  /* ===== RENDER POSTS ===== */
  function renderPosts() {
    postsList.innerHTML = "";
    profile.posts.forEach((p, idx) => {
      const div = document.createElement("div");
      div.className = "post-item";
      div.innerHTML = `
        <div><strong>${p.type.toUpperCase()}</strong> – ${p.caption || ""}</div>
        <div style="font-size:0.8rem;opacity:0.9;">Likes: ${p.likes || 0} • Views: ${p.views || 0}</div>
        <button class="delete-btn" data-idx="${idx}">Delete</button>
      `;
      postsList.appendChild(div);
    });

    postsList.querySelectorAll(".delete-btn").forEach(btn => {
      btn.onclick = () => {
        profile.posts.splice(btn.dataset.idx, 1);
        renderPosts();
      };
    });
  }

  /* ===== RENDER LESSONS ===== */
  function renderLessons() {
    const lessons = getLessons();
    lessonsList.innerHTML = "";

    lessons.forEach((ls, idx) => {
      const div = document.createElement("div");
      div.className = "lesson-item";
      div.innerHTML = `
        <div><strong>${ls.title}</strong> – $${ls.price}, ${ls.duration} min</div>
        <div style="font-size:0.9rem;opacity:0.9;">${ls.description}</div>
        <button class="delete-btn" data-idx="${idx}">Delete</button>
      `;
      lessonsList.appendChild(div);
    });

    lessonsList.querySelectorAll(".delete-btn").forEach(btn => {
      btn.onclick = () => {
        const lessons = getLessons();
        lessons.splice(btn.dataset.idx, 1);
        saveLessons(lessons);
        renderLessons();
      };
    });
  }

  renderPosts();
  renderLessons();

  /* ===== ADD LESSON ===== */
  document.getElementById("addLessonBtn").onclick = () => {
    const title = document.getElementById("lessonTitle").value.trim();
    const price = document.getElementById("lessonPrice").value.trim();
    const duration = document.getElementById("lessonDuration").value.trim();
    const description = document.getElementById("lessonDescription").value.trim();

    if (!title) return;

    const lessons = getLessons();
    lessons.push({ title, price, duration, description });
    saveLessons(lessons);

    document.getElementById("lessonTitle").value = "";
    document.getElementById("lessonPrice").value = "";
    document.getElementById("lessonDuration").value = "";
    document.getElementById("lessonDescription").value = "";

    renderLessons();
  };

  /* ===== SAVE PROFILE ===== */
  document.getElementById("saveProfileBtn").onclick = () => {
    profile.name = nameEl.value.trim() || "Your Name";
    profile.bio = bioEl.value.trim();
    profile.link = linkEl.value.trim();
    profile.instagram = instaEl.value.trim();

    localStorage.setItem(LS_PROFILE, JSON.stringify(profile));
    window.location.href = "profile.html";
  };
</script>
