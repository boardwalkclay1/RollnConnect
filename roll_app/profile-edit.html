<script>
document.addEventListener("DOMContentLoaded", () => {
  const LS_PROFILE = "rc_user_profile";
  const LS_LESSONS = "rc_user_lessons";
  const LS_CLIPS   = "rc_user_clips";

  function safeParse(key, fallback) {
    try {
      const raw = localStorage.getItem(key);
      if (!raw) return fallback;
      return JSON.parse(raw);
    } catch (e) {
      return fallback;
    }
  }

  // Load profile data
  const p = safeParse(LS_PROFILE, {});

  document.getElementById("username").textContent = p.name || "Unnamed";
  document.getElementById("handle").textContent = p.username ? "@" + p.username : "@unknown";
  document.getElementById("bio").textContent = p.bio || "";
  document.getElementById("avatar").src = p.avatarUrl || "assets/default-avatar.png";
  document.getElementById("clip-preview").src = p.profileClipUrl || "assets/default-clip.png";

  // Stats
  document.getElementById("post-count").textContent   = p.postsCount || 0;
  document.getElementById("clip-count").textContent   = p.clipsCount || 0;
  document.getElementById("event-count").textContent  = p.eventsCount || 0;

  // Load lessons
  const lessons = safeParse(LS_LESSONS, []);
  const lessonsContainer = document.getElementById("lessons-section");
  if (lessonsContainer) {
    lessonsContainer.innerHTML = lessons.length
      ? lessons.map(ls => `
          <div class="lesson-item">
            <strong>${ls.title}</strong><br>
            ${ls.price ? "$" + ls.price : "Free"} â€¢ ${ls.duration} min<br>
            <span>${ls.description || ""}</span>
          </div>
        `).join("")
      : "<p>No lessons yet.</p>";
  }

  // Load clips
  const clips = safeParse(LS_CLIPS, []);
  const clipsContainer = document.getElementById("clips-section");
  if (clipsContainer) {
    clipsContainer.innerHTML = clips.length
      ? clips.map(url => `
          <div class="clip-item">
            <video src="${url}" controls></video>
          </div>
        `).join("")
      : "<p>No clips yet.</p>";
  }
});
</script>
